<x-app-layout>
    <section class="text-center mt-9 pt-7">
        <img class="h-auto max-w-lg mx-auto mb-6 " src="{{ asset('storage/img/umb.png') }}" alt="" width="70px">
        <h1
            class="mb-4 text-3xl font-extrabold leading-none tracking-tight text-gray-900 md:text-5xl lg:text-5xl dark:text-white">
            Diagram Hasil Pemilihan</h1>
        <p class="mb-6 text-lg font-normal text-gray-500 lg:text-xl sm:px-16 xl:px-48 dark:text-gray-400">
            Presiden dan Wakil Presiden Mahasiswa serta HIMAPRODI Peternakan & Ilmu Aktuaria <br>
            Universitas Muhammadiyah Bulukumba
        </p>
    </section>

    <section class="bg-neutral-600 m-9 p-5 border border-gray-200">
        <div class="text-center bg-white mt-9 pt-7 border mb-5 rounded-lg shadow">
            <figure class="highcharts-figure py-5">
                <div id="container"></div>
            </figure>
        </div>

        <div class="text-center pb-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 justify-center"
            id="cards1">
            <div
                class="card1 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pemilih dalam</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Daftar Pemilih Tetap (DPT)</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card2 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pengguna Hak Pilih</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Dalam DPT</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card3 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 01</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>

            <div
                class="card4 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 02</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>
        </div>
    </section>

    <section class="bg-neutral-600 m-9 p-5 border border-gray-200">
        <div class="text-center bg-white mt-9 pt-7 border mb-5 rounded-lg shadow">
            <figure class="highcharts-figure py-5">
                <div id="container2"></div>
            </figure>
        </div>

        <div class="text-center pb-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 justify-center"
            id="cards2">
            <div
                class="card1 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pemilih dalam</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Daftar Pemilih Tetap (DPT)</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card2 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pengguna Hak Pilih</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Dalam DPT</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card3 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 01</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>

            <div
                class="card4 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 02</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>
        </div>
    </section>

    <section class="bg-neutral-600 m-9 p-5 border border-gray-200">
        <div class="text-center bg-white mt-9 pt-7 border mb-5 rounded-lg shadow">
            <figure class="highcharts-figure py-5">
                <div id="container3"></div>
            </figure>
        </div>

        <div class="text-center pb-5 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 justify-center"
            id="cards3">
            <div
                class="card1 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pemilih dalam</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Daftar Pemilih Tetap (DPT)</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card2 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Jumlah Pengguna Hak Pilih</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Dalam DPT</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Pemilih</p>
            </div>

            <div
                class="card3 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 01</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>

            <div
                class="card4 block p-5 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                <p class="font-normal text-gray-700 dark:text-gray-400">Paslon No. 02</p>
                <p class="font-normal text-gray-700 dark:text-gray-400 mb-3">Calon</p>

                <h2 class="inline text-7xl font-bold tracking-tight text-gray-900 dark:text-white">
                    739
                </h2>
                <p class="inline text-gray-700 dark:text-gray-400 font-bold text-2xl">Suara</p>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            function fetchDataAndUpdateChart(dataKey, cardId) {
                // Fungsi untuk mengubah konten kartu berdasarkan ID
                fetch("/live-count-api") // Gantilah ini dengan route yang tepat
                    .then((response) => response.json())
                    .then((data) => {
                        function updateCard(cardClass, secondText, headingText) {

                            // Menangkap elemen kartu berdasarkan ID
                            const card = document.querySelector('#' +
                                cardId + ' .' + cardClass);

                            // Menangkap elemen <p> pertama, <p> kedua, dan <h2>
                            const firstParagraph = card.querySelector('p'); // <p> pertama
                            const secondParagraph = firstParagraph.nextElementSibling; // <p> kedua
                            const heading = card.querySelector('h2'); // <h2>

                            // Mengubah isi dari elemen yang ditangkap
                            // firstParagraph.textContent = firstText;
                            secondParagraph.textContent = secondText;
                            heading.textContent = headingText;
                        }

                        // Contoh penggunaan fungsi untuk mengubah konten kartu
                        updateCard('card1', 'Daftar Pemilih Tetap (DPT)', data[
                            dataKey].jumlahdpt);

                        updateCard('card2', 'Dalam DPT', data[
                            dataKey].penggunahakpilih);

                        updateCard('card3', data[dataKey].namapaslon[0].pasangan_calon,
                            data[
                                dataKey].count[
                                0]);

                        updateCard('card4', data[dataKey].namapaslon[1]
                            .pasangan_calon, data[
                                dataKey].count[
                                1]);
                    });
            }

            fetchDataAndUpdateChart("bem", "cards1");
            fetchDataAndUpdateChart("peter", "cards2");
            fetchDataAndUpdateChart("akt", "cards3");

            setInterval(() => fetchDataAndUpdateChart("bem", "cards1"), 7 * 60000);
            setInterval(() => fetchDataAndUpdateChart("peter", "cards2"), 7 * 60000);
            setInterval(() => fetchDataAndUpdateChart("akt", "cards3"), 7 * 60000);
        });
    </script>
</x-app-layout>
